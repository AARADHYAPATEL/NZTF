<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Footprint</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <nav>
            <a href="index.html">Home</a>
            <a href="appliance.html">Appliance Footprint</a>
        </nav>
        <h1>Vehicle Footprint</h1>
        <form id="vehicle-form">
            <div class="form-group">
                <label for="num-vehicles">Number of Vehicles</label>
                <input type="number" id="num-vehicles" name="num-vehicles" min="1" value="1">
            </div>
            <div class="form-group">
                <label for="calc-mode">Select Calculation Mode</label>
                <select id="calc-mode" name="calc-mode">
                    <option value="daily">Daily</option>
                    <option value="monthly">Monthly</option>
                    <option value="yearly">Yearly</option>
                    <option value="custom">Custom</option>
                </select>
            </div>
            <div id="vehicle-details"></div>
            <button type="button" class="button" onclick="addVehicleInputs()">Add Vehicles</button>
            <button type="button" class="button" onclick="calculateVehicleEmission()">Calculate Vehicle Emission</button>
        </form>
        <div id="vehicle-results" class="results"></div>
        <div id="emission-message" class="message"></div>
        <div id="change-options" class="change-options" style="display: none;">
            <h3>How would you like to change?</h3>
            <label><input type="radio" name="change-option" value="public-transport"> Use Public Transport</label><br>
            <label><input type="radio" name="change-option" value="cycling"> Start Cycling</label><br>
            <label><input type="radio" name="change-option" value="walking"> Walk More</label><br>
            <label><input type="radio" name="change-option" value="electric-car"> Switch to an Electric Car</label><br>
            <button type="button" class="button" onclick="submitChange()">Submit</button>
        </div>
    </div>

    <script>
        const transportModes = {
            "Car (Petrol)": 0.24,
            "Car (Diesel)": 0.27,
            "Bus": 0.05,
            "Train": 0.04,
            "Bicycle": 0.0,
            "Walking": 0.0,
            "Electric Car": 0.12,
        };

        const calcMode = document.getElementById("calc-mode");
        calcMode.addEventListener("change", addVehicleInputs);

        function addVehicleInputs() {
            const numVehicles = parseInt(document.getElementById('num-vehicles').value) || 1;
            const vehicleDetails = document.getElementById('vehicle-details');
            vehicleDetails.innerHTML = '';
            for (let i = 0; i < numVehicles; i++) {
                vehicleDetails.innerHTML += `
                    <div class="form-group">
                        <h3>Vehicle ${i + 1}</h3>
                        <label for="vehicle-${i}-mode">Mode of Transport</label>
                        <select id="vehicle-${i}-mode">
                            ${Object.keys(transportModes).map(mode => `<option value="${mode}">${mode}</option>`).join('')}
                        </select>
                        <label for="vehicle-${i}-distance">Daily Distance (km)</label>
                        <input type="number" id="vehicle-${i}-distance" min="0" step="0.1">
                    </div>`;
            }
        }

        function calculateVehicleEmission() {
            const numVehicles = parseInt(document.getElementById('num-vehicles').value) || 1;
            const vehicleResults = document.getElementById('vehicle-results');
            const emissionMessage = document.getElementById('emission-message');
            const changeOptions = document.getElementById('change-options');
            vehicleResults.innerHTML = '';
            emissionMessage.innerHTML = '';
            changeOptions.style.display = 'none';
            let totalEmission = 0;
            for (let i = 0; i < numVehicles; i++) {
                const mode = document.getElementById(`vehicle-${i}-mode`).value;
                const distance = parseFloat(document.getElementById(`vehicle-${i}-distance`).value) || 0;
                const emission = distance * transportModes[mode] * 30; // Monthly assumption
                totalEmission += emission;
                vehicleResults.innerHTML += `<p><strong>Vehicle ${i + 1}:</strong> ${emission.toFixed(2)} kg CO₂</p>`;
            }
            vehicleResults.innerHTML += `<hr><p><strong>Total Vehicle Emission:</strong> ${totalEmission.toFixed(2)} kg CO₂</p>`;
            if (totalEmission > 50) {
                emissionMessage.innerHTML = "<p class='high-emission'>⚠️ Your emissions are quite high! Consider switching to eco-friendly transport options. ⚠️</p>";
                changeOptions.style.display = 'block';
            }
        }

function showChangeOptions() {
    const emissionMessage = document.getElementById('emission-message');

    // Create a div to hold the options
    const optionsDiv = document.createElement('div');
    optionsDiv.id = "change-options";

    // Create the question
    const question = document.createElement('p');
    question.innerHTML = "<strong>How would you like to change?</strong>";
    optionsDiv.appendChild(question);

    // Define options
    const options = ["Public Transport", "Carpooling", "Electric Vehicle", "Bicycling", "Walking"];

    // Create radio buttons
    options.forEach(option => {
        const label = document.createElement('label');
        const radio = document.createElement('input');
        radio.type = "radio";
        radio.name = "change-option";
        radio.value = option;

        label.appendChild(radio);
        label.appendChild(document.createTextNode(" " + option));
        optionsDiv.appendChild(label);
        optionsDiv.appendChild(document.createElement("br"));
    });

    // Create submit button
    const submitButton = document.createElement('button');
    submitButton.id = "submit-change";
    submitButton.style.display = "none"; // Initially hidden
    submitButton.innerText = "Submit";
    submitButton.onclick = submitChange;
    optionsDiv.appendChild(submitButton);

    // Append everything to the emission message div
    emissionMessage.appendChild(optionsDiv);

    // Show the submit button only when a radio button is selected
    document.querySelectorAll('input[name="change-option"]').forEach(option => {
        option.addEventListener('change', function() {
            document.getElementById('submit-change').style.display = "block";
        });
    });
}

function submitChange() {
    const selectedOption = document.querySelector('input[name="change-option"]:checked').value;

    // Send the data to the database (submit_change.php)
    fetch('submit_change.php', {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: `change_option=${encodeURIComponent(selectedOption)}`
    })
    .then(response => response.text())
    .then(data => {
        alert("Your choice has been submitted: " + selectedOption);
    })
    .catch(error => {
        console.error("Error submitting choice:", error);
    });
}
</script>
</body>
</html>

